<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TFC Executive Board Portfolio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 20px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #f59e0b; }
        .active-tab { background-color: #f59e0b !important; color: white !important; box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.3); }
        .sidebar-item { transition: all 0.3s ease; cursor: pointer; }
        .chart-tile { background: white; border-radius: 1.5rem; border: 1px solid #e2e8f0; padding: 1.5rem; transition: all 0.3s ease; height: 100%; display: flex; flex-direction: column; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        .chart-tile:hover { border-color: #f59e0b; box-shadow: 0 12px 30px -10px rgba(0,0,0,0.08); }
        input[type=range] { -webkit-appearance: none; background: transparent; cursor: pointer; }
        input[type=range]::-webkit-slider-runnable-track { background: #f1f5f9; border-radius: 10px; height: 8px; border: 1px solid #e2e8f0; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 24px; width: 24px; border-radius: 50%; background: #f59e0b; margin-top: -9px; border: 3px solid white; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .metric-value { font-feature-settings: "tnum"; }
    </style>
</head>
<body class="text-slate-800 selection:bg-orange-100">

    <div class="flex h-screen overflow-hidden">
        <!-- SIDEBAR -->
        <aside class="w-80 bg-white border-r border-slate-200 flex flex-col shrink-0 z-50">
            <div class="p-8">
                <div class="flex items-center gap-4 mb-16">
                    <div class="w-12 h-12 bg-orange-500 rounded-2xl flex items-center justify-center text-white shadow-2xl shadow-orange-500/30">
                        <i data-lucide="layers"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-black leading-none uppercase tracking-tighter">Nexus</h1>
                        <p class="text-[10px] text-slate-400 font-bold uppercase tracking-widest mt-1">Board Meeting Analytics</p>
                    </div>
                </div>

                <nav class="space-y-3">
                    <div onclick="switchTab('overview')" id="btn-overview" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="layout-dashboard"></i> Report Home
                    </div>
                    <div onclick="switchTab('purchasing')" id="btn-purchasing" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="truck"></i> Purchasing Audit
                    </div>
                    <div onclick="switchTab('sales')" id="btn-sales" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="shopping-cart"></i> Sales Strategy
                    </div>
                    <div onclick="switchTab('scm')" id="btn-scm" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="zap"></i> SCM Synchronization
                    </div>
                    <div onclick="switchTab('ops')" id="btn-ops" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="factory"></i> Operations Hub
                    </div>
                    <div onclick="switchTab('lab')" id="btn-lab" class="sidebar-item w-full flex items-center gap-5 px-6 py-4 rounded-xl font-black text-xs uppercase tracking-widest text-slate-400 hover:bg-slate-50 hover:text-orange-500">
                        <i data-lucide="sliders"></i> Strategic Lab
                    </div>
                </nav>
            </div>
            <div class="mt-auto p-12">
                <div class="bg-slate-50 p-6 rounded-[2rem] border border-slate-100 shadow-inner">
                    <div class="flex items-center gap-3 mb-4">
                        <i data-lucide="shield-check" size="18" class="text-orange-500"></i>
                        <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest">Board Verified</span>
                    </div>
                    <p class="text-[12px] font-mono text-slate-800 font-black uppercase">R6_SYNC_FINAL</p>
                </div>
            </div>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="flex-1 overflow-y-auto p-12 lg:p-16 custom-scrollbar relative bg-[#f8fafc]">
            <header class="flex justify-between items-center mb-16 border-b border-slate-200 pb-12">
                <div>
                    <h1 class="text-6xl font-black text-slate-800 tracking-tighter uppercase leading-[0.8]">Strategic <br/><span class="text-orange-500">Board Deck</span></h1>
                    <div class="flex items-center gap-8 mt-8">
                        <span class="text-xs font-black text-slate-400 uppercase tracking-[0.5em]">Presentation: 18.12.2025</span>
                        <div class="w-12 h-px bg-slate-300"></div>
                        <span class="text-xs font-black text-orange-600 uppercase tracking-widest flex items-center gap-3"><i data-lucide="target" size="18"></i> Operational Sync: 100%</span>
                    </div>
                </div>
                <div class="w-20 h-20 bg-slate-800 rounded-[2.5rem] flex items-center justify-center text-white shadow-2xl">
                    <i data-lucide="cpu" size="40"></i>
                </div>
            </header>

            <!-- TAB CONTENT CONTAINERS -->
            <div id="content-area" class="space-y-12 pb-24">
                <!-- Content will be injected here by JS -->
            </div>

            <footer class="mt-40 pt-16 border-t border-slate-200 flex justify-between items-center opacity-60 text-[10px] font-black uppercase tracking-[0.3em] font-mono">
                <div class="flex items-center gap-12 text-slate-400">
                    <span class="flex items-center gap-3"><i data-lucide="target" size="16"></i> Global_Network_Sync</span>
                    <span class="flex items-center gap-3"><i data-lucide="file-text" size="16"></i> Audit_Verified_R6</span>
                </div>
                <span class="text-slate-500">Nexus Pro Intelligence © 2025 Board Disclosure</span>
            </footer>
        </main>
    </div>

    <script>
        // --- DATASET: INTEGRATED FROM BOOK1 & FINANCE REPORTS ---
        const simData = [
            { round: -2, roi: -6.67, revenue: 2628, cogs: 1.85, indirect: 120.1, rel: 83.8, rej: 5.79, sl: 93.7, shelf: 85.0, error: 49.5, inUtil: 95.4, outUtil: 88.0, adherence: 82.6, lostRev: 180, stock: 4.2, rmCost: 46.2, downtime: 15.2, prodAvail: 92.1 },
            { round: -1, roi: -7.68, revenue: 2628, cogs: 1.85, indirect: 120.5, rel: 84.1, rej: 5.89, sl: 94.8, shelf: 85.9, error: 48.9, inUtil: 93.3, outUtil: 85.0, adherence: 82.9, lostRev: 185, stock: 4.3, rmCost: 46.5, downtime: 15.5, prodAvail: 93.2 },
            { round: 0,  roi: -7.68, revenue: 2628, cogs: 1.85, indirect: 120.5, rel: 84.1, rej: 5.89, sl: 94.8, shelf: 85.9, error: 48.9, inUtil: 93.3, outUtil: 85.0, adherence: 82.9, lostRev: 185, stock: 4.3, rmCost: 46.5, downtime: 15.5, prodAvail: 93.2 },
            { round: 1,  roi: -5.72, revenue: 2559, cogs: 1.82, indirect: 122.3, rel: 74.0, rej: 5.79, sl: 94.9, shelf: 85.9, error: 45.8, inUtil: 80.5, outUtil: 82.0, adherence: 81.7, lostRev: 210, stock: 4.8, rmCost: 45.8, downtime: 16.8, prodAvail: 94.1 },
            { round: 2,  roi: -0.59, revenue: 2616, cogs: 1.78, indirect: 125.1, rel: 79.4, rej: 6.48, sl: 95.5, shelf: 88.6, error: 38.6, inUtil: 89.4, outUtil: 88.0, adherence: 83.2, lostRev: 140, stock: 4.0, rmCost: 44.2, downtime: 14.1, prodAvail: 95.5 },
            { round: 3,  roi: 2.15,  revenue: 2582, cogs: 1.75, indirect: 130.4, rel: 92.3, rej: 5.83, sl: 97.1, shelf: 83.7, error: 35.1, inUtil: 60.5, outUtil: 75.0, adherence: 85.6, lostRev: 95, stock: 3.5, rmCost: 43.1, downtime: 12.2, prodAvail: 94.8 },
            { round: 4,  roi: 1.68,  revenue: 2671, cogs: 1.72, indirect: 145.2, rel: 93.2, rej: 5.05, sl: 95.2, shelf: 88.3, error: 30.4, inUtil: 116.6, outUtil: 80.0, adherence: 88.3, lostRev: 80, stock: 3.2, rmCost: 42.5, downtime: 10.5, prodAvail: 96.2 },
            { round: 5,  roi: 2.44,  revenue: 2680, cogs: 1.70, indirect: 148.1, rel: 93.5, rej: 5.04, sl: 97.9, shelf: 87.2, error: 28.7, inUtil: 83.7, outUtil: 85.0, adherence: 91.4, lostRev: 45, stock: 3.0, rmCost: 41.8, downtime: 9.1, prodAvail: 97.5 },
            { round: 6,  roi: 4.54,  revenue: 2656, cogs: 1.68, indirect: 150.3, rel: 94.1, rej: 3.71, sl: 98.2, shelf: 86.8, error: 22.1, inUtil: 89.8, outUtil: 90.2, adherence: 93.6, lostRev: 25, stock: 2.8, rmCost: 40.2, downtime: 7.8, prodAvail: 98.2 },
        ];

        const chartColors = ['#f59e0b', '#1e293b', '#ef4444', '#10b981'];

        const commonOptions = {
            chart: { toolbar: { show: false }, zoom: { enabled: false }, fontFamily: 'Inter', background: 'transparent' },
            stroke: { curve: 'smooth', width: 4 },
            grid: { borderColor: '#f1f5f9', padding: { left: 10, right: 10 } },
            colors: chartColors,
            dataLabels: { enabled: false },
            markers: { size: 4, strokeWidth: 2, strokeColors: '#fff', hover: { size: 7 } },
            legend: { position: 'top', horizontalAlign: 'right', fontSize: '10px', fontWeight: 900, textTransform: 'uppercase' }
        };

        function switchTab(tabId) {
            document.querySelectorAll('.sidebar-item').forEach(el => el.classList.remove('active-tab'));
            document.getElementById(`btn-${tabId}`).classList.add('active-tab');

            const container = document.getElementById('content-area');
            container.innerHTML = '';

            if (tabId === 'overview') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                        ${renderKPITile('ROI Milestone', '4.54%', '+11.2%', 'trending-up')}
                        ${renderKPITile('Realized Revenue', '€2.65M', '+1.1%', 'dollar-sign')}
                        ${renderKPITile('COGS Index', '0.88', '-12.0%', 'target')}
                        ${renderKPITile('Plan Adherence', '93.6%', '+13.4%', 'zap')}
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2 chart-tile p-12 relative overflow-hidden border-l-8 border-l-orange-500">
                            <i data-lucide="globe" style="width: 300px; height: 300px;" class="absolute top-0 right-0 opacity-[0.03] text-orange-500"></i>
                            <h3 class="text-xs font-black text-orange-600 uppercase tracking-widest mb-6">Simulation Vision</h3>
                            <h2 class="text-6xl font-black text-slate-800 leading-tight mb-8">SYNC <br/><span class="text-orange-500 italic uppercase">Excellence</span></h2>
                            <p class="text-2xl text-slate-600 leading-relaxed italic font-serif">
                                "Eliminating operational friction to capture premium contract index bonuses through engineered 98%+ service reliability."
                            </p>
                        </div>
                        <div class="bg-slate-900 p-12 rounded-[2.5rem] flex flex-col justify-between text-white shadow-2xl">
                           <div>
                             <h3 class="text-8xl font-black tracking-tighter text-orange-500">+4.54%</h3>
                             <p class="text-xs font-black mt-4 uppercase tracking-[0.4em] opacity-60">Aggregate Performance</p>
                           </div>
                           <div class="space-y-6 pt-8 border-t border-white/10">
                              <div class="flex justify-between text-xs font-bold uppercase tracking-widest"><span>Service Peak</span><span class="text-emerald-400">98.2%</span></div>
                              <div class="flex justify-between text-xs font-bold uppercase tracking-widest"><span>Plan Adherence</span><span class="text-emerald-400">93.6%</span></div>
                              <div class="h-1 bg-white/10 rounded-full overflow-hidden"><div class="h-full bg-orange-500 w-[94%]"></div></div>
                           </div>
                        </div>
                    </div>

                    <div class="chart-tile min-h-[450px]">
                        <h4 class="text-slate-400 text-[10px] font-black uppercase mb-8 tracking-[0.2em] border-l-2 border-orange-500 pl-4">Financial Lifecycle: ROI vs Revenue Vector</h4>
                        <div id="chart-main-roi" class="h-[350px]"></div>
                        <div class="mt-4 p-4 bg-orange-50 border-l-4 border-orange-500 rounded-r-xl">
                            <p class="text-[11px] text-orange-900 font-semibold italic">The pivot in Round 2 marks our transition to positive ROI as structural COGS reduction outpaced revenue volatility.</p>
                        </div>
                    </div>
                `;
                new ApexCharts(document.querySelector("#chart-main-roi"), {
                    ...commonOptions,
                    chart: { ...commonOptions.chart, height: 350 },
                    series: [
                        { name: 'ROI %', type: 'area', data: simData.map(d => d.roi) },
                        { name: 'Revenue (M€)', type: 'line', data: simData.map(d => d.revenue) }
                    ],
                    xaxis: { categories: simData.map(d => "R" + d.round) },
                    yaxis: [{ title: { text: 'ROI %' } }, { opposite: true, title: { text: 'Revenue' } }]
                }).render();

            } else if (tabId === 'purchasing') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                        ${renderChartTile('1. Reliability vs ROI (Regression)', 'p1', 'Book1 Linkage: 10% gain in reliability = +2% ROI. Linear correlation (0.87) proves consistency drives uptime.')}
                        ${renderChartTile('2. Rejection Rate vs COGS Inflator', 'p2', 'Audit: Each 1% rejection adds €15k to COGS. reduction to 3.71% recovered €42k in material replacement.')}
                        ${renderChartTile('3. Obsolete % vs Indirect Cost', 'p3', 'Efficiency: Each 1% obsoletes = +$8K indirect cost. Managing RM inventory lowered warehouse overhead by 8%.')}
                        ${renderChartTile('4. RM Cost Index Timeline', 'p4', 'Procurement Logic: structural reduction in material index from 46.5 to 40.2 achieved via tiered volume contracts.')}
                        ${renderChartTile('5. Component Revenue Impact Share', 'p5', 'PET Bottles represent 48% of volume risk. Stockout protection here is the top mandate.')}
                        <div class="bg-white border border-slate-200 rounded-2xl p-8 shadow-sm h-full flex flex-col">
                            <h4 class="text-slate-800 text-[11px] font-black uppercase mb-6 tracking-widest flex items-center gap-2 border-b pb-4"><i data-lucide="clipboard-list"></i> 6. Supplier Performance</h4>
                            <table class="w-full text-left text-[11px] mt-4">
                                <tr class="text-slate-400 font-black border-b"><th>Vendor</th><th>ROI Impact</th><th>Status</th></tr>
                                <tr class="border-b"><td class="py-4 font-bold">Arancia</td><td class="text-emerald-600">+2.45%</td><td>Preferred</td></tr>
                                <tr class="border-b"><td class="py-4 font-bold">Trio PET</td><td class="text-emerald-600">+1.33%</td><td>Benchmark</td></tr>
                                <tr><td class="py-4 font-bold text-rose-600">Miami</td><td class="text-rose-600">-0.88%</td><td>Terminate</td></tr>
                            </table>
                        </div>
                    </div>
                `;
                renderScatter("#p1", simData.map(d => ({ x: d.rel, y: d.roi })), 'ROI %');
                renderBar("#p2", simData.map(d => d.rej), 'Rej %');
                renderScatter("#p3", simData.map(d => ({ x: d.obsolete, y: d.indirect })), 'Cost €');
                renderLine("#p4", simData.map(d => d.rmCost), 'RM Index');
                renderDonut("#p5", [48, 31, 12, 9], ['PET', 'Pack', 'Conc.', 'Other']);

            } else if (tabId === 'sales') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                        ${renderChartTile('1. Shelf Life vs Revenue Shield', 's1', '↑1% shelf life gain = +€25k realized revenue. Blocked retailer penalties destroying R1 margins.')}
                        ${renderChartTile('2. Service Level vs ROI Efficiency', 's2', 'The 98% Strategy: Every 1% gain = +0.5% ROI. R6 hit 98.2%, unlocking tiered contract bonuses.')}
                        ${renderChartTile('3. Forecast Error (MAPE) vs COGS', 's3', 'Reduction Logic: Decreasing MAPE to 22.1% removed €140k in rush-order surcharges from structural COGS.')}
                        ${renderChartTile('4. Product Availability (OSA) vs ROI', 's4', 'OSA reached 98.2% in R6. ensuring contracted sales were realized without backorder costs.')}
                        ${renderChartTile('5. Customer ROI Weighting (Matrix)', 's5', 'Food & Groceries carries 49% of our ROI weighting. Service precision here is mission-critical.')}
                        <div class="bg-white border border-slate-200 rounded-2xl p-8 shadow-sm h-full flex flex-col"><h4 class="text-slate-800 text-[11px] font-black uppercase mb-6 tracking-widest flex items-center gap-2 border-b pb-4"><i data-lucide="clipboard-list"></i> 6. Account Strategy</h4><table class="w-full text-left text-[11px] mt-4"><tr class="text-slate-400 font-black border-b"><th>Account</th><th>ROI Contrib</th><th>Tier</th></tr><tr class="border-b"><td class="py-4 font-bold">F&G</td><td class="text-emerald-600">+2.85%</td><td>Critical</td></tr><tr class="border-b"><td class="py-4 font-bold">Dominick's</td><td class="text-emerald-600">+1.15%</td><td>Strategic</td></tr><tr><td class="py-4 font-bold">LAND</td><td class="text-emerald-600">+0.54%</td><td>Volume</td></tr></table></div>
                    </div>
                `;
                renderBar("#s1", simData.map(d => d.shelf), 'Shelf %');
                renderScatter("#s2", simData.map(d => ({ x: d.sl, y: d.roi })), 'ROI %');
                renderLine("#s3", simData.map(d => d.error), 'MAPE %');
                renderArea("#s4", simData.map(d => d.prodAvail), 'OSA %');
                renderBar("#s5", [49, 27, 24], 'Weight', ['F&G', 'DOM', 'LAND']);

            } else if (tabId === 'ops') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                        ${renderChartTile('1. Inbound Util vs COGS Stress', 'o1', 'R4 Overflow Crisis: 116.6% utilization triggered €29k in storage penalties. structural fix in R5 recovered flow.')}
                        ${renderChartTile('2. Plan Adherence vs ROI', 'o2', 'Internal Driver: 10% adherence gain = +5% ROI. Reaching 93.6% ensured maximum fixed cost absorption.')}
                        ${renderChartTile('3. Bottling Downtime vs COGS Impact', 'o3', 'Quantified Savings: ↓5% downtime = -$40k COGS reduction. Reducing 15h to 7.8h saved €60k+.')}
                        ${renderChartTile('4. Breakdown vs Adherence Timeline', 'o4', 'Solve Breakdown projects in R5 successfully neutralized random failure, stabilizing throughput.')}
                        ${renderChartTile('5. Outbound Util vs Indirect Overhead', 'o5', 'Efficiency Curve: Flow at 90.2% ensured maximum fixed cost absorption without triggering overtime.')}
                        <div class="bg-white border border-slate-200 rounded-2xl p-8 shadow-sm h-full flex flex-col"><h4 class="text-slate-800 text-[11px] font-black uppercase mb-6 tracking-widest flex items-center gap-2 border-b pb-4"><i data-lucide="clipboard-list"></i> 6. Segment ROI Audit</h4><table class="w-full text-left text-[11px] mt-4"><tr class="text-slate-400 font-black border-b"><th>Operational Node</th><th>ROI Impact</th><th>Status</th></tr><tr class="border-b"><td class="py-4 font-bold">Bottling</td><td class="text-emerald-600">+1.22%</td><td>Maintain</td></tr><tr class="border-b"><td class="py-4 font-bold">Mixing</td><td class="text-emerald-600">+0.85%</td><td>Stable</td></tr><tr><td class="py-4 font-bold text-rose-600">WH Node</td><td class="text-rose-600">-0.38%</td><td>Corrected</td></tr></table></div>
                    </div>
                `;
                renderBar("#o1", simData.map(d => d.inUtil), 'WH Util %');
                renderScatter("#o2", simData.map(d => ({ x: d.adherence, y: d.roi })), 'ROI %');
                renderBar("#o3", simData.map(d => d.downtime), 'Hrs');
                renderLineMultiple("#o4", simData.map(d => d.downtime), simData.map(d => d.adherence), ['Breakdown', 'Adherence']);
                renderScatter("#o5", simData.map(d => ({ x: d.outUtil, y: d.indirect })), 'Cost €');

            } else if (tabId === 'scm') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
                        ${renderChartTile('1. Component Avail. vs Revenue leakage', 'c1', 'Audit: R1 stockouts caused €210k leakage. R6Reached 100% availability, securing full potential.')}
                        ${renderChartTile('2. Product OSA vs ROI Synergy', 'c2', 'Every 3% gain in On-Shelf Avail yielded +2% in net ROI through bonus contract triggers.')}
                        ${renderChartTile('3. Stock Weeks vs Service level', 'c3', 'Efficiency Logic: R6 hit Lean Frontier: 98% service with 2.8 weeks of stock. Initial was 4.3.')}
                        ${renderChartTile('4. Component ROI Priority (ABC)', 'c4', 'PET Bottles are A-Critical. Stockout risk directly caps production and realized revenue.')}
                        <div class="bg-white border border-slate-200 rounded-2xl p-8 shadow-sm h-full flex flex-col"><h4 class="text-slate-800 text-[11px] font-black uppercase mb-6 tracking-widest flex items-center gap-2 border-b pb-4"><i data-lucide="clipboard-list"></i> 5. Product ROI Priority</h4><table class="w-full text-left text-[11px] mt-4"><tr class="text-slate-400 font-black border-b"><th>Product</th><th>Margin</th><th>ROI Rank</th></tr><tr class="border-b"><td class="py-4 font-bold">Orange 1L</td><td>High</td><td>Primary</td></tr><tr class="border-b"><td class="py-4 font-bold">Mango PET</td><td>Med</td><td>Secondary</td></tr><tr><td class="py-4 font-bold">C-Power</td><td>High</td><td>Niche</td></tr></table></div>
                        <div class="bg-white border border-slate-200 rounded-2xl p-8 shadow-sm h-full flex flex-col"><h4 class="text-slate-800 text-[11px] font-black uppercase mb-6 tracking-widest flex items-center gap-2 border-b pb-4"><i data-lucide="clipboard-list"></i> 6. Inventory Risk Profile</h4><table class="w-full text-left text-[11px] mt-4"><tr class="text-slate-400 font-black border-b"><th>Category</th><th>Value</th><th>Risk</th></tr><tr class="border-b"><td class="py-4 font-bold">Finished</td><td>€280k</td><td>Low</td></tr><tr class="border-b"><td class="py-4 font-bold">Raw Mat</td><td>€140k</td><td>Medium</td></tr><tr><td class="py-4 font-bold">Packaging</td><td>€25k</td><td>Minimal</td></tr></table></div>
                    </div>
                `;
                renderArea("#c1", simData.map(d => d.lostRev), 'Lost K€');
                renderLine("#c2", simData.map(d => d.prodAvail), 'OSA Index');
                renderScatter("#c3", simData.map(d => ({ x: d.stock, y: d.sl })), 'Service %');
                renderBar("#c4", [100, 85, 40, 20], 'Priority', ['PET', 'Pack 1L', 'Conc.', 'Vit C']);

            } else if (tabId === 'lab') {
                container.innerHTML = `
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="bg-white border border-slate-200 p-12 rounded-[2.5rem] space-y-12 shadow-sm">
                            <div class="space-y-6">
                                <div class="flex justify-between items-center"><label class="text-xs font-black text-slate-700 uppercase tracking-widest">Supplier Reliability</label><span id="lab-rel-val" class="text-sm font-black text-orange-600">94%</span></div>
                                <input type="range" id="lab-rel-slider" min="70" max="100" value="94" class="w-full" oninput="updateSimulation()">
                            </div>
                            <div class="space-y-6">
                                <div class="flex justify-between items-center"><label class="text-xs font-black text-slate-700 uppercase tracking-widest">Plan Adherence</label><span id="lab-adh-val" class="text-sm font-black text-orange-600">93%</span></div>
                                <input type="range" id="lab-adh-slider" min="80" max="100" value="93" class="w-full" oninput="updateSimulation()">
                            </div>
                            <div class="space-y-6">
                                <div class="flex justify-between items-center"><label class="text-xs font-black text-slate-700 uppercase tracking-widest">Service Level</label><span id="lab-sl-val" class="text-sm font-black text-orange-600">98%</span></div>
                                <input type="range" id="lab-sl-slider" min="90" max="100" value="98" class="w-full" oninput="updateSimulation()">
                            </div>
                            <button onclick="resetLab()" class="w-full py-5 bg-slate-800 text-white text-xs font-black uppercase rounded-2xl transition-all flex items-center justify-center gap-3">
                                <i data-lucide="refresh-ccw"></i> Revert to Round 6 Data
                            </button>
                        </div>
                        <div class="lg:col-span-2 bg-gradient-to-br from-orange-500 to-amber-600 p-24 rounded-[3.5rem] flex flex-col justify-center items-center text-center shadow-2xl text-white relative overflow-hidden">
                           <h3 id="lab-roi-val" class="text-[12rem] font-black tracking-tighter leading-none shadow-orange-900/20">4.54%</h3>
                           <div class="mt-12 flex items-center gap-10 py-6 px-16 bg-white/20 rounded-full text-3xl font-black border border-white/10 backdrop-blur-md">
                             <i data-lucide="arrow-right"></i> 
                             <span id="lab-delta-val">+0.00% Improvement</span>
                           </div>
                        </div>
                    </div>
                `;
            }

            lucide.createIcons();
        }

        // --- CHART HELPERS ---
        function renderKPITile(label, val, trend, icon) {
            return `
                <div class="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm flex flex-col group hover:border-orange-500 transition-all">
                    <div class="flex justify-between items-start mb-6">
                        <div class="p-3 bg-orange-50 text-orange-600 rounded-xl group-hover:bg-orange-500 group-hover:text-white transition-all shadow-sm"><i data-lucide="${icon}"></i></div>
                        <span class="text-xs font-black px-2 py-1 rounded-full bg-emerald-50 text-emerald-600">${trend}</span>
                    </div>
                    <p class="text-slate-500 text-[10px] font-black uppercase tracking-widest">${label}</p>
                    <h3 class="text-4xl font-black text-slate-800 mt-3 tracking-tighter">${val}</h3>
                </div>
            `;
        }

        function renderChartTile(title, id, insight) {
            return `<div class="chart-tile"><h4 class="text-slate-400 text-[10px] font-black uppercase mb-8 tracking-[0.2em] border-l-2 border-orange-500 pl-4">${title}</h4><div id="${id}"></div><div class="mt-4 p-4 bg-orange-50 border-l-4 border-orange-500 rounded-r-xl"><p class="text-[11px] text-orange-900 font-semibold italic">${insight}</p></div></div>`;
        }

        function renderScatter(el, data, name) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 200, type: 'scatter' }, series: [{ name, data: data }], xaxis: { type: 'numeric' } }).render();
        }
        function renderBar(el, data, name, cats) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 200, type: 'bar' }, series: [{ name, data }], xaxis: { categories: cats || simData.map(d => "R"+d.round) } }).render();
        }
        function renderLine(el, data, name) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 200, type: 'line' }, series: [{ name, data }], xaxis: { categories: simData.map(d => "R"+d.round) } }).render();
        }
        function renderArea(el, data, name) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 200, type: 'area' }, series: [{ name, data }], xaxis: { categories: simData.map(d => "R"+d.round) } }).render();
        }
        function renderDonut(el, data, labels) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 220, type: 'donut' }, series: data, labels: labels }).render();
        }
        function renderLineMultiple(el, d1, d2, names) {
            new ApexCharts(document.querySelector(el), { ...commonOptions, chart: { height: 200, type: 'line' }, series: [{ name: names[0], data: d1 }, { name: names[1], data: d2 }], xaxis: { categories: simData.map(d => "R"+d.round) } }).render();
        }

        function updateSimulation() {
            const rel = parseInt(document.getElementById('lab-rel-slider').value);
            const adh = parseInt(document.getElementById('lab-adh-slider').value);
            const sl = parseInt(document.getElementById('lab-sl-slider').value);
            document.getElementById('lab-rel-val').innerText = rel + "%";
            document.getElementById('lab-adh-val').innerText = adh + "%";
            document.getElementById('lab-sl-val').innerText = sl + "%";
            const relShift = (rel - 94) * 0.20; 
            const adherenceShift = (adh - 93) * 0.50; 
            const serviceShift = (sl - 98) * 0.50; 
            const finalRoi = 4.54 + relShift + adherenceShift + serviceShift;
            const delta = finalRoi - 4.54;
            document.getElementById('lab-roi-val').innerText = finalRoi.toFixed(2) + "%";
            document.getElementById('lab-delta-val').innerText = (delta >= 0 ? "+" : "") + delta.toFixed(2) + "% Change";
        }

        function resetLab() {
            document.getElementById('lab-rel-slider').value = 94;
            document.getElementById('lab-adh-slider').value = 93;
            document.getElementById('lab-sl-slider').value = 98;
            updateSimulation();
        }

        window.onload = () => {
            switchTab('overview');
        };
    </script>
</body>
</html>
